(window.webpackJsonp=window.webpackJsonp||[]).push([[183],{238:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return s}));var a=n(2),r=n(6),i=(n(0),n(354)),o={title:"Helm Development Guide",sidebar_label:"Helm"},l={unversionedId:"developer/developers-guide-helm",id:"version-4.3.0/developer/developers-guide-helm",isDocsHomePage:!1,title:"Helm Development Guide",description:"This document is currently in progress and will be expanded in the future.",source:"@site/versioned_docs/version-4.3.0/developer/developers-guide-helm.md",permalink:"/docs/4.3.0/developer/developers-guide-helm",editUrl:"https://github.com/cloudfoundry/stratos/edit/master/website/versioned_docs/version-4.3.0/developer/developers-guide-helm.md",version:"4.3.0",sidebar_label:"Helm",sidebar:"version-4.3.0/docs",previous:{title:"Deploy Dev Guide",permalink:"/docs/4.3.0/developer/deploy"},next:{title:"Kubernetes Features in Local Development",permalink:"/docs/4.3.0/developer/developers-guide-kube-local-dev"}},c=[{value:"Building Images",id:"building-images",children:[{value:"Base Images",id:"base-images",children:[]},{value:"All Other Images",id:"all-other-images",children:[]}]},{value:"Building Charts",id:"building-charts",children:[{value:"Testing built output",id:"testing-built-output",children:[]}]}],b={rightToc:c};function s(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"This document is currently in progress and will be expanded in the future."))),Object(i.b)("h2",{id:"building-images"},"Building Images"),Object(i.b)("p",null,"The images references by the helm charts are built in two stages."),Object(i.b)("h3",{id:"base-images"},"Base Images"),Object(i.b)("p",null,"Changes to these happen infrequently, so not every dev cycle requires this step."),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Ensure your docker hub credentials are set",Object(i.b)("ol",{parentName:"li"},Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"docker login")))),Object(i.b)("li",{parentName:"ol"},"Create and push images to docker hub",Object(i.b)("ol",{parentName:"li"},Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"cd deploy/stratos-base-images")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"./build-base-images.sh -o dockerhuborgname -p"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"p")," pushes the images to dockerhub. Replace ",Object(i.b)("inlineCode",{parentName:"li"},"dockerhuborgname")," with the docker hub org where test images should be pushed"))),Object(i.b)("li",{parentName:"ol"},"Wait for script to complete, this may take a while")))),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"If you receive the error ",Object(i.b)("inlineCode",{parentName:"p"},'"--squash" is only supported on a Docker daemon with experimental features enabled')," during build enable\nexperimental feature by"),Object(i.b)("ol",{parentName:"div"},Object(i.b)("li",{parentName:"ol"},"Add ",Object(i.b)("inlineCode",{parentName:"li"},'"experimental": true')," to ~/.docker/config.json"),Object(i.b)("li",{parentName:"ol"},"Restart docker - ",Object(i.b)("inlineCode",{parentName:"li"},"sudo systemctl restart docker")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"docker version")," should show client with experimental feature enabled")))),Object(i.b)("h3",{id:"all-other-images"},"All Other Images"),Object(i.b)("p",null,"Changes to these will occur more often and are built upon the base images created above. This step is executed with the command command used\nto build the charts below."),Object(i.b)("h2",{id:"building-charts"},"Building Charts"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Ensure your docker hub credentials are set",Object(i.b)("ol",{parentName:"li"},Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"docker login")))),Object(i.b)("li",{parentName:"ol"},"Create the charts, and create and push images to docker hub",Object(i.b)("ol",{parentName:"li"},Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"cd deploy/kubernetes")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"./build.sh -t 4.0.1 -o dockerhuborgname -p"),"\n-",Object(i.b)("inlineCode",{parentName:"li"},"p")," pushes the images to dockerhub. Replace ",Object(i.b)("inlineCode",{parentName:"li"},"dockerhuborgname")," with the docker hub org where test images should be pushed. This should match where your base images are\n-",Object(i.b)("inlineCode",{parentName:"li"},"t")," will tag the images with a version"),Object(i.b)("li",{parentName:"ol"},"The new charts with updated image references will be created in ",Object(i.b)("inlineCode",{parentName:"li"},"deploy/kubernetes/helm-charts"))))),Object(i.b)("h3",{id:"testing-built-output"},"Testing built output"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"cd deploy/kubernetes")),Object(i.b)("li",{parentName:"ol"},"Install the usual way, with your namespace and values (if required). For example",Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"helm install console helm-chart --namespace=console --values stratos-values.yaml\n")))))}s.isMDXComponent=!0},354:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=r.a.createContext({}),s=function(e){var t=r.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=s(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,b=c(e,["components","mdxType","originalType","parentName"]),d=s(n),m=a,u=d["".concat(o,".").concat(m)]||d[m]||p[m]||i;return n?r.a.createElement(u,l(l({ref:t},b),{},{components:n})):r.a.createElement(u,l({ref:t},b))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var b=2;b<i;b++)o[b]=n[b];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);