<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<title data-react-helmet="true">Configuring Single Sign On | STRATOS</title><meta data-react-helmet="true" name="docsearch:version" content="next"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Configuring Single Sign On | STRATOS"><meta data-react-helmet="true" name="description" content="By default, Stratos will authenticate against a UAA using username and password, for both logging into Stratos and when connecting Cloud Foundry endpoints."><meta data-react-helmet="true" property="og:description" content="By default, Stratos will authenticate against a UAA using username and password, for both logging into Stratos and when connecting Cloud Foundry endpoints."><meta data-react-helmet="true" property="og:url" content="https://stratos.app/docs/next/advanced/sso"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://stratos.app/docs/next/advanced/sso"><link rel="stylesheet" href="/styles.60bb3a68.css">
<link rel="preload" href="/styles.5a9bf666.js" as="script">
<link rel="preload" href="/runtime~main.6e8825e8.js" as="script">
<link rel="preload" href="/main.749533ae.js" as="script">
<link rel="preload" href="/1.330bc1cf.js" as="script">
<link rel="preload" href="/2.8bc44564.js" as="script">
<link rel="preload" href="/18b93cb3.105f20a2.js" as="script">
<link rel="preload" href="/1be78505.d47c44f0.js" as="script">
<link rel="preload" href="/c4f5d8e4.8e4861f9.js" as="script">
<link rel="preload" href="/299.238cf4dc.js" as="script">
<link rel="preload" href="/298.aa6cc89c.js" as="script">
<link rel="preload" href="/c6c6e257.71ae886d.js" as="script">
<link rel="preload" href="/17896441.ae9d786c.js" as="script">
<link rel="preload" href="/38da5ade.ef2783f5.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Stratos"><strong class="navbar__title">STRATOS</strong></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/next/">Latest</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/advanced/sso">Latest</a></li><li><a class="dropdown__link" href="/docs/advanced/sso">4.4.0</a></li><li><a class="dropdown__link" href="/docs/4.3.0/advanced/sso">4.3.0</a></li><li><a class="dropdown__link" href="/docs/4.2.0/advanced/sso">4.2.0</a></li><li><a class="dropdown__link" href="/docs/4.1.0/advanced/sso">4.1.0</a></li><li><a class="dropdown__link" href="/docs/4.0.0/advanced/sso">4.0.0</a></li><li><a class="dropdown__link" href="/versions">All Versions</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://github.com/cloudfoundry/stratos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx" style="margin-left:2px">üåô</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx" style="margin-left:1px">‚òÄÔ∏è</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Stratos"><strong class="navbar__title">STRATOS</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/next/advanced/sso">Latest</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/advanced/sso">4.4.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.3.0/advanced/sso">4.3.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.2.0/advanced/sso">4.2.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.1.0/advanced/sso">4.1.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.0.0/advanced/sso">4.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/versions">All Versions</a></li></ul></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/cloudfoundry/stratos" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Stratos</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/license">License</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deploy</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/overview">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Cloud Foundry</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/cloud-foundry/cloud-foundry">Deploy as an Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/cloud-foundry/db-migration">Database service bindings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/cloud-foundry/cf-troubleshooting">Troubleshooting</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/kubernetes">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/kubernetes/helm-installation">Deploy using Helm</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/kubernetes/eksdeployment">Stratos on EKS</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/all-in-one">Docker All-in-One</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/tech-preview">Tech Preview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/access">Accessing Stratos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploy/troubleshooting">Troubleshooting</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Endpoints</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/endpoints/introduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Cloud Foundry</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/endpoints/cf/cf">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/endpoints/cf/invite-user-guide">Configuring User Invites</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/endpoints/k8s">Kubernetes</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Metrics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/endpoints/metrics/metrics">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/endpoints/metrics/bosh-metrics">Connecting Prometheus-boshrelease</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/endpoints/helm">Helm</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Advanced Topics</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/next/advanced/sso">Configuring Single Sign On</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Develop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/contributing">Contributing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/introduction">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Frontend</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/frontend">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/frontend-tests">Tests</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Backend</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/backend">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Deploy</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/deploy">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/developers-guide-helm">Helm</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/developers-guide-kube-local-dev">Kube Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/developers-guide-e2e-tests">E2E Tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/developer/developers-guide-env-tech">Dev Links &amp; Env</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Extend</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/extensions/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/extensions/disable-packages">Remove Packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/extensions/v4-migration">Migrating to V4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/extensions/theming">Theming Stratos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/extensions/frontend">Frontend Extensions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/extensions/backend">Backend Plugins</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="alert alert--secondary margin-bottom--md" role="alert"><div class="container_2r0I">This is the development documentation. For the latest released documentation see <strong><a href="/docs/advanced/sso"> 4.4.0</a></strong>.</div></div><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: next</span></div><header><h1 class="docTitle_1Lrw">Configuring Single Sign On</h1></header><div class="markdown"><p>By default, Stratos will authenticate against a UAA using username and password, for both logging into Stratos and when connecting Cloud Foundry endpoints.</p><p>UAA can support richer login mechanisms than username and password. To accommodate this, you can configure Stratos to use the UAA&#x27;s Single Sign On UI for login.</p><p>This can be enabled by setting the config setting SSO_LOGIN to true.</p><p>Most importantly, you will need to ensure that the Client used when communicating with your UAA is configured to allow Stratos to use Single Sign On - i.e. that the Stratos SSO Login callback URI is registered with the UAA.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="adding-the-stratos-sso-callback-uri"></a>Adding the Stratos SSO Callback URI<a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-the-stratos-sso-callback-uri" title="Direct link to heading">#</a></h2><p>You&#x27;ll need the <code>uaac</code> CLI to configure your Client to accept the Stratos SSO Callback URI - see <a href="https://github.com/cloudfoundry/cf-uaac" target="_blank" rel="noopener noreferrer">here</a>.</p><blockquote><p>NOTE: The Stratos SSO Redirect URI that you&#x27;ll need is:
<code>https://HOST.DOMAIN/pp/v1/auth/sso_login_callback</code>
where <code>HOST</code> and <code>DOMAIN</code> depend on your Stratos installation.</p></blockquote><p>Target your UAA</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uaac target &lt;UAA URL&gt;</span></div></div></div></div></div><p>Login to your UAA with the <code>admin</code> client:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uaac token client get admin -s &lt;ADMIN_CLIENT_SECRET&gt;</span></div></div></div></div></div><p>Next, check the configuration of your Client - for example, for the <code>cf</code> client:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uaac client get cf</span></div></div></div></div></div><p>You&#x27;ll get the current configuration - there are two properties of interest <code>redirect_uri</code> and <code>authorized_grant_types</code>.</p><blockquote><p>Note: The following commands will overwrite existing values for the settings specified. To keep the existing values along with the new value include them in the new value as a comma-separated list.</p></blockquote><p>The <code>redirect_uri</code> value should contain the Stratos redirect URI. If not update the Client with:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uaac client update cf --redirect_uri https://HOST.DOMAIN/pp/v1/auth/sso_login_callback</span></div></div></div></div></div><p>The <code>authorized_grant_types</code> value should contain <code>authorization_code</code>. If not update the Client with:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uaac client update cf --authorized_grant_types authorization_code</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="adding-a-stratos-sso-state-allow-list"></a>Adding a Stratos SSO State Allow-list<a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-a-stratos-sso-state-allow-list" title="Direct link to heading">#</a></h2><p>When SSO has been configured Stratos&#x27;s log in request will contain a URL that tells SSO where to return to. When using a browser this is automatically populated. To avoid situations where this can be hijacked or called separately an SSO <code>state</code> allow-list can be provided via the environment variable <code>SSO_ALLOWLIST</code>. This is a comma separated list. For example...</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">SSO_ALLOWLIST=https://your.domain/*</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">SSO_ALLOWLIST=https://your.domain/*,https://your.other.domain/*</span></div></div></div></div></div><p>When set, any requests to log in with a different <code>state</code> will be denied.</p><p>In order for the SSO <code>state</code> to match an entry from the allow-list the schema, hostname, port and path must match exactly. A wildcard <code>*</code> can be provided for the path to match anything.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="advanced-configuration"></a>Advanced Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#advanced-configuration" title="Direct link to heading">#</a></h2><p>Further configuration of SSO is provided through the <code>SSO_OPTIONS</code> environment variable.</p><p>Setting this variable to <code>nosplash</code> will skip the need for users to press the Login button - users will jump straight to the configured SSO endpoint when accessing Stratos instead of first seeing the Stratos login page.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-a-dedicated-uaa-client-for-stratos"></a>Using a dedicated UAA Client for Stratos<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-a-dedicated-uaa-client-for-stratos" title="Direct link to heading">#</a></h3><p>In production environments, it&#x27;s wise to setup a dedicated UAA client for
Stratos SSO, instead of re-using the <code>cf</code> client, that already represents by
the <code>cf</code> CLI.</p><p>In this case, you can duplicate the <code>cf</code> client definition and create a
<code>stratos-console</code> client, for example. In typical UAA deployment manifest with
BOSH, you would typically add the following configuration properties to the
<code>uaa</code> job, in the <code>uaa</code> instance group.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">uaa</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">clients</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">stratos-console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">authorized-grant-types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> authorization_code</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">redirect-uri</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">//console.((system_domain))/pp/v1/auth/sso_login_callback</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">autoapprove</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Bypass users approval</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># The following properties are copied from those of the default &#x27;cf&#x27; client:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">access-token-validity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">600</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">authorities</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> uaa.none</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">override</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">refresh-token-validity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2592000</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">scope</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> network.admin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">network.write</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">cloud_controller.read</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">cloud_controller.write</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">openid</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">password.write</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">cloud_controller.admin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">scim.read</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">scim.write</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">doppler.firehose</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">uaa.user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">routing.router_groups.read</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">routing.router_groups.write</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">cloud_controller.admin_read_only</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">cloud_controller.global_auditor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">perm.admin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">clients.read</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">secret</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="listing-the-stratos-console-as-a-registered-application-in-uaa-users-home-page"></a>Listing the Stratos console as a registered application in UAA users home page<a aria-hidden="true" tabindex="-1" class="hash-link" href="#listing-the-stratos-console-as-a-registered-application-in-uaa-users-home-page" title="Direct link to heading">#</a></h3><p>With the above UAA client set though, the Stratos Console would still not be
displayed as a registered SSO application in UAA users home page. (This home
page is typically hosted at <code>https://login.{SYSTEM_DOMAIN}/home</code>.)</p><p>In order to properly list the Stratos Console there, the <code>show-on-homepage</code>
property has to be set to <code>true</code> and the <code>app-launch-url</code> property has to be
perperly provided, with some non-<code>null</code> URL.</p><p>The example below shows the whole setup, with a simplified PNG image as the
<code>app-icon</code> though, to keep is concise.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uaa:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  clients:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    stratos-console:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      name: Stratos Console</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      show-on-homepage: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      app-launch-url: https://console.((system_domain))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      app-icon: iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAD1BMVEWZttQvMDEoKisqKywAAAApvvoVAAAAGElEQVQYlWNgYUQBLAxMDCiAeXgLoHsfAD03AHOyfqy1AAAAAElFTkSuQmCC</span></div></div></div></div></div><p>If you need an <code>app-icon</code> that properly displays the Stratos logo though, here
is one you could use. This is the Stratos logo, reduced to 68x68 because
that&#x27;s the size the UAA users home page will display it. This is still 4.91 KB
of PNG data though, as it is Base64-encoded.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uaa:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  clients:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    stratos-console:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      app-icon: iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH5AwGFzociVt2KgAADe1JREFUeNrtnFtsHOd1x39n9sa98H4RbV0tkbpTlmVYF8qxJdlG3ARoCjdogz64TdwitduXuGiRtg9C/BIYSR8CtE0bFHGTIoadoK2dpLbUWnVt2ZVlJ6IkSrZESrZoilrxTpF73505fdjZ3dnhkhIlUiLTHGFBzsw3wzn/Pef/nXO+8wl+LWUid/KPW5aFiOwEttunTqnqccMw/n99C5Zl+VX1K6p6XqfLeVV9yrIs/688EKoaUdWvqeoVvb5E7bGRX0UgalT166o6qnOXUVX9S1WtXfIcoqotwNeAp4FpCinoWJreS0m9IMDqoLQ1BGiXyu91DfhH4G9EZGhJAaKqK4C/Av4ACE7jECU3kqH37JSeGcsSc15r8BHeEpGOpgDthuCt8PgU8ALwTRHpX9SAqGob8OfAlwFfBSAyV1Oc657SMzGT9GzPCnsIbKuWLa1VbDKESgSbBX4AfEtEehYVIKq6A/gL4HcrXTeVdDTJ2e4p/ShhkZnLs0MG/q3VsunuIFs8QmCGYT8BnheRX95RQFT1AeAg8PlK17MW8ctJzpyNaU/aIncrfytg4N0SkfYVQTp8BuEZhr0GPHfw4MHjzz333O0BxA6mHgP+Gni40piMxdTVFOeTpsZ9htxKPKHu902amgh5JLw8yGa/Qc0M9x0Fvqmqry9YkGdZFqr6hKqemGl+TOZ07Pyk9faVpJ6yVE1dIDEtzZyfst4+N2m9lcjNOpWfUNUvWpY1fxZiW8TvAV8HOiqNSeQYuhjXUz0JLj/UIHuaA2y8HTHDhZi+c2qK3vYQy9vCsj3kpWWGoWeB51X1X65nMXIdjggCrwKPVboezzHYG9Oui0miAPdWs74tInsL13ujXL56TeOKiKWIoqJQ+iiiiAEqKqBgqOSvIUjhdxUK/4wtjRJcW5efyi0ld2JCD/elGAJYF+Sutohsj3hpnUGlN4AviEhizoDYlvHzSoQ5kaWvN6bdn6YYLpxbE6Tlvlr5bCF2eK9Xz32/i8s5xciBYVr2TxATDFMKx2KYooZpIKaBYYJhGmUfsTz2757855UOadzaSKhA3EdH9efjOYpKrqiicUNYOur83FNBtddV9XMzWYrMYh2fBQ45z41luHhuSk9HM0y4g6kHG+TzBfa/NMzA8/+jH5qKLAQgK/0YL22X5mWhfHwSzzH43yN6OKOYzve6y0/dxmrZ1uBnnUu93xCRQ5X0ns2hft95cPqa/uebo/q2Gwy/4NlZJw8XwBiPM/G9Y/rhQnJHn4kePKfj8RwWQNjLst31sss9Lpph4s1RffvUNT08m27XBURVAYpckDAZ6U0wUGnsnnrZFfayDCCdJfWj97VrKot1Sxrr9YccSmF+94JOmPbY5gAbtlezoSL5JriSMEvuDeydaeaZyUKWA6sKB1NZBisNuq9GNjYF8i+hir52Wk98fI3UgsXPLqC+c43MzwZ0qnC8NiK77gnmvxy3TGZxJoQrRWTlXADZW84dOi27vCfIsnvCFM30g0+0+9gA47c7N3/mKsmT4/kvQcDTUSP7GnzTI9mxjLq/1M65AFI2+Eq6DF0afIS31co+se/vG6HvlY/ou1P1lj/t1/hAkiyAzyC0q072+V2ZslsH95d+w4BkLWITjinNb+DdVS/7vZKf9iYSjL7Ypd3zWz+YY4BmoQf7NTZlk2zIS0tnvewuK6bkSGYspuZsIZZlBYEHivyRK0e2s052hzw02ySa/NeT+kHiVkl0HlLOn2aw/j6q8Zzm4WwM0L6jRjY5x8TKdbnfsqzQdQERkb3lQVjJ93bUsKkxQLsdJZpHzuv7A7F5INF5km/Fyf3bSOl91oTZ6STZcRePiMiDN+Iye5wHg7bvrQ3SuiZcmutPXqbr5CCji61++9UJzX4Qy/OJgLGtVg4USHYwM41H9swJEEvJDqQZa/AR7qiV/YVaZ/84F458opcWrhh7a7c/NaLp/kw+avUKVbvr5RG/4LmSZtzUsgLV7ICYplnGvrEcgwHBs7teHvEKVQDXkgy/el5PLubSdx/osyOanrLy0AY9NO5tkL2SD/OHXAGazAiIYRhboVR0mcwx3NkgnUEPjQAZk8RrPfpu1ppnEl0AOWSh357QdM62tgY/63bUyObJckAiItIxm8s8WB7CYzX6aSuQ6Dt9enQktXhI9Hry7Sz6clyzhePVIXZMZnXCNewzswFSdtFv5N0E4OI4p3quMcYSkz9MY3XbYYEh+DyCx8VSD1YExE52iiSTNBn1SGkpIRrTIZao9Oa06OI+EV/SLJsd99jJbDkgInIXlAoqU1kGEyaThePWsDQvVUDaPWKUeFEnJ8uT1dXAikouUxbKjmZ1cDhdCmQagyxZQFZ5i/OWfppiqEKyursSIGVzcjTFcH+aESXvfzUBmm49Qrj98oQBtUYekKTJaFYxZ0v0jEonsxbx8RxxU7ESuXxhxech1BqccYFo0co+b0nHQk1kIkciY5WtKZcDYjen7K6UBDn9bU3N0nObzT6RSjURV4D2gJ3U5gGZntCVQBjLarH01hyWpqUGyFqHhThdZTw7LdHb63SZMkIdSpdIZyBVekhdcMaFoMVJpgLLbEDcdZ3BdOVEz3CzrKXk+tOMFKdfk1Tayk+/YT91Ed/0NofFKn/ko7j64qqFMJBmzFKy0wCxA7K9Dt8adHfwOIvM6+tZMm6z1V9yl3FXoVzs5NWV6GGIyEag3pnQuR/sLBK1Vi8dHlnrKwVkThpwVAOdutaIyGYDyqfSlKlx941Rh781hJaGheSAlT57FlWyl9PT87Ckqe413qAB5VWver9MW9cYynDN1HyWWxukSZYAIH/sxQhI3vXjOYYqvXMFXccNVb0EnCtagJ+2rRHWum+O2eZlCJ719dQtdkD2BBwBWW7ajMLWCGsLpQ1belT1Y8NeBf9GWTIUkb0rAvmikDvKA1hTL4t++t0YEE/h9xFX7rIiQGN7RNzrMt8wDCOPoqq+BPxzMXwVvDvq5EC1p1QPGXZEeU3hcrAWZQzimGH6HbFUtYeqHXVywNXy+UNVfbEYhxiGgar+CXC8WDcwiHQ2yH6P5Mf053tBtMAjixmMxz1InR2QpUzGCg1/hiCdDbLPZ+BsF39fVZ8u9IsUUTQMI0G+rTJaOBfx0tpZJw8A5BQrbvNIwEtweYTQYgXkkSo8lXKxzjrZGfFyl2PoVeB3bN2nlxBFpM8GpdhU21LF5m3VefKZdAQy6xpk0brNlkAJkDE7huqopm1ZFZsdw9LAl2ydqQiIDcpR8v3pRWmLSOeqKpqdhZXltYs3r2mrKhFqNM3Qyiqa2sPiXsv9MxF5y33vTA0z3wX+yRHmerbXyv5rOaYKPHJ3Has6V87Y3HZHxC/IjxrEv8yft5CMxZSpWPfVygGRktUA31fVv6v0jNl6zALAm85KWjzHYMpksrC+CzCZZOJ0v158rZcrORMjZ2Fk7Z8L1WNmeexz9mdDAM+zLVQ91CjBWke6/3Fcjy0LyNpCh5Mt76nqfsMwUnMCxAZlOfAejiLsWIaLfoOwu/UxnibW1acX/v0jopnc7QFkvR/vs3cT2rdMQlWecmsfTueDTVfP7ACwW0Quz6TzdaNwVd1jW0qx8f5iTN81FXNVSDqqPKXEECCRJnHqU730yodEx9PoQgByfxDPM6uo3tUiYTcQsRzRnph21XipbSsPvjLAfhH539n0vaG0RFWfcnKKgnliQg9/kmRwa4R71oRkW5WHBuc9mRyZU33a95NurlxNo/MByJ4wvmfapPbeZiJeY1qJYuB8TLv6UgyvrqLl/jp53MUbXxWR711P1xvO02wSesZZiH5nTP9jLEscoC3E8nVh2eZ2pWyO7Ol+Bl46rVc+TWDdECBiW4MNyL5aAl9ul/qOZiIeFxBjGT7uiWn3gJ3N1nsJf6ax1DNryz8cOXLk6UcffZR5A8SyLL+I/BfwUNE9cgwdGdFDzobZ1VU0b4jIfdU+lpel4ybm+SiDL57SgQ8nyd2IhfxmM1VfbJfGjU1US/mb6mia3rMx7R7OlBbTvILnsSZ53NXz/g7wiIjc0D6dOWXyqtpqh/fFls2RND1vjem77rErAjSuj0hHvau92lKsnijDL3Zr9BfjZCsB8luthH57ozSvbaTada9pb007XbBMpzzcIJ2FNtFCGgPsEpHojeo459KGvWnoLRx76T6Oc6xrUs9VGt/ip2ZTRDoaXZsLVdHeQUZf/Yihw0OaNg3kS6uo+dwGaVlZV5ZrYCnZwRQfnZ5la9p9NbJhbbisWJ4C9onI8bnod1O1HlV9kvx+twLJWl0TeuiTZOUGX8i3cm6tlm1NeWA8ZQWoSeJ+L566UCm7BjCVTDTFme7J2bemrQmybEedPC7lgeZXROSFuep2U9uNdu7c+UPgOw5UjW21sr9Sw2wppyD+9pgee2NIfxxN0e1sbWqpIewEI2uRuBTn+OtD+vLxCT01GxgNXsL3OnpmbfnbJ5988oWb0e2mq4GWZXlE5A1gX5FkTUaOjOjrmRvYXxc08G2rls2tQTZ5Je9+aZOJ/iRnz8T0gqnX71IKGHgPNMrjIW/ZiuJbqvqoYRi52wqI7TqNwC/JtxTYRWrGr6boMV1bNWbNQQwCFlg5q2ydZFbxCJ7WKta7AsNPgZ0iMnizOt1yvdjeonoU7nh9JAE8LCK/uJWH3PKWRRE5AXzBfqE7JUngiVsFY15FVTer6suqmtHbJ1lV/bGqbp4vPeZ9icWyLK+I3MvC/2ctlqqevlny/LXcoPwf/6YD/WnLhhgAAAAASUVORK5CYII=</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="troubleshooting"></a>Troubleshooting<a aria-hidden="true" tabindex="-1" class="hash-link" href="#troubleshooting" title="Direct link to heading">#</a></h2><ol><li><p>User has selected the incorrect application authorities when logging in to Stratos via SSO for the first time.</p><ul><li>The user can update their permissions and other account settings via <a href="https://login." target="_blank" rel="noopener noreferrer">https://login.</a>&lt; uaa address &gt;/profile</li></ul></li><li><p>Administrator wants to remove the application authorities selection users see when logging in to Stratos via SSO for the first time</p><ul><li><p>This is carried out at the Admins discretion</p></li><li><p>Using the <code>uaac</code> cli update the &#x27;autoapprove&#x27; property of the client used by Stratos to either <code>true</code> for all authorities or a comma separated list for the authorities to be removed.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uaac client update &lt;console client&gt; --autoapprove true</span></div></div></div></div></div></li></ul></li><li><p>User sees the error message <code>No scopes were granted</code> when trying to log in to Stratos via SSO</p><ul><li>User may not have selected any of the application authorities when logging in to Stratos via SSO for the first time</li><li>Either of the resolutions to 1 and 2 can be made</li></ul></li></ol></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/cloudfoundry/stratos/edit/master/website/docs/advanced/sso.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/endpoints/helm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Helm Endpoints</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/developer/contributing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contributing ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#adding-the-stratos-sso-callback-uri" class="table-of-contents__link">Adding the Stratos SSO Callback URI</a></li><li><a href="#adding-a-stratos-sso-state-allow-list" class="table-of-contents__link">Adding a Stratos SSO State Allow-list</a></li><li><a href="#advanced-configuration" class="table-of-contents__link">Advanced Configuration</a><ul><li><a href="#using-a-dedicated-uaa-client-for-stratos" class="table-of-contents__link">Using a dedicated UAA Client for Stratos</a></li><li><a href="#listing-the-stratos-console-as-a-registered-application-in-uaa-users-home-page" class="table-of-contents__link">Listing the Stratos console as a registered application in UAA users home page</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link">Troubleshooting</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/deploy/overview">Deploying Stratos</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://cloudfoundry.slack.com/?redir=%2Fmessages%2Fstratos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://github.com/cloudfoundry/stratos" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/talks">Presentations and Talks</a></li></ul></div></div><div class="text--center"><div>Copyright ¬© 2021 Cloud Foundry Foundation</div></div></div></footer></div>
<script src="/styles.5a9bf666.js"></script>
<script src="/runtime~main.6e8825e8.js"></script>
<script src="/main.749533ae.js"></script>
<script src="/1.330bc1cf.js"></script>
<script src="/2.8bc44564.js"></script>
<script src="/18b93cb3.105f20a2.js"></script>
<script src="/1be78505.d47c44f0.js"></script>
<script src="/c4f5d8e4.8e4861f9.js"></script>
<script src="/299.238cf4dc.js"></script>
<script src="/298.aa6cc89c.js"></script>
<script src="/c6c6e257.71ae886d.js"></script>
<script src="/17896441.ae9d786c.js"></script>
<script src="/38da5ade.ef2783f5.js"></script>
</body>
</html>