<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<title data-react-helmet="true">Developing the Stratos Console | STRATOS</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Developing the Stratos Console | STRATOS"><meta data-react-helmet="true" name="description" content="1. Introduction"><meta data-react-helmet="true" property="og:description" content="1. Introduction"><meta data-react-helmet="true" property="og:url" content="https://stratos.app/docs/guides/developers/developers-guide"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://stratos.app/docs/guides/developers/developers-guide"><link rel="stylesheet" href="/styles.3c40d568.css">
<link rel="preload" href="/styles.d3be2d04.js" as="script">
<link rel="preload" href="/runtime~main.de635b0d.js" as="script">
<link rel="preload" href="/main.777ea05f.js" as="script">
<link rel="preload" href="/1.222372fe.js" as="script">
<link rel="preload" href="/2.34eb096d.js" as="script">
<link rel="preload" href="/44.c6ce18b1.js" as="script">
<link rel="preload" href="/45.0e0f5b82.js" as="script">
<link rel="preload" href="/20ac7829.07547941.js" as="script">
<link rel="preload" href="/17896441.836a2f96.js" as="script">
<link rel="preload" href="/1ca4dc62.61ebe050.js" as="script">
</head>
<body>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Stratos"><strong class="navbar__title">STRATOS</strong></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://github.com/cloudfoundry/stratos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Stratos"><strong class="navbar__title">STRATOS</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/cloudfoundry/stratos" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Documentation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deploying Stratos</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deploy/deploy-overview">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Cloud Foundry</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deploy/cloud-foundry">Deploy on Cloud Foundry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deploy/cloud-foundry/db-migration">Database service bindings</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deploy/kubernetes">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deploy/kubernetes/helm-installation">Deploy using Helm</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deploy/all-in-one">Docker All-in-One</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deploy/access">Accessing Stratos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deploy/troubleshooting">Troubleshooting</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Advanced Topics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/invite-user-guide">Configuring User Invites</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/sso">Configuring Single Sign On</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Contributing to Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/contribution/contributing">Contributing to Stratos</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Developer</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/guides/developers/developers-guide">Stratos Development</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/developers/developers-guide-env-tech">Dev Environment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/developers/developers-guide-e2e-tests">E2E Tests</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Extending Stratos</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extensions/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guides/customization/customizing">Customizing Stratos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extensions/theming">Theming Stratos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extensions/frontend">Frontend Extensions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extensions/backend">Backend Plugins</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Developing the Stratos Console</h1></header><div class="markdown"><ol><li><a href="#introduction">Introduction</a></li><li><a href="#frontend-development">Frontend Development</a></li><li><a href="#backend-development">Backend Development</a></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="introduction"></a>Introduction<a aria-hidden="true" tabindex="-1" class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>Stratos comprises of two main components:</p><ul><li>A front-end UI that runs in your web browser. This is written in <a href="https://www.typescriptlang.org/" target="_blank" rel="noopener noreferrer">Typescript</a> and uses the <a href="https://angular.io/" target="_blank" rel="noopener noreferrer">Angular</a> framework.</li><li>A back-end that provides a web-based API to the front-end. This is written in Go.</li></ul><p>Depending on what you are contributing, you will need to develop with the front-end, back-end or both.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="frontend-development"></a>Frontend Development<a aria-hidden="true" tabindex="-1" class="hash-link" href="#frontend-development" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="introduction-to-the-stack"></a>Introduction to the stack<a aria-hidden="true" tabindex="-1" class="hash-link" href="#introduction-to-the-stack" title="Direct link to heading">#</a></h3><p>Have a look through the <a href="/docs/guides/developers/developers-guide-env-tech">Env + Tech</a> page to get acquainted with some of the new technologies used in v2.
These include video&#x27;s, tutorials and examples of Angular 2+, Typescript and Redux. There&#x27;s also some advice on helpful plugins to use if
using Visual Studio Code. If you feel comfortable with these and are happy with your dev environment please skip straight to
<a href="#set-up-dependencies">Set up Dependencies</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="set-up-dependencies"></a>Set up Dependencies<a aria-hidden="true" tabindex="-1" class="hash-link" href="#set-up-dependencies" title="Direct link to heading">#</a></h3><ul><li>Set up a Stratos backend - The frontend cannot run without a backend. Both backend and frontend exist in this same repo.<ul><li>Don&#x27;t need to make changes to the backend code? To set up a backend run through the <a href="https://github.com/cloudfoundry/stratos/blob/master/deploy/README.md">deploy section</a>,
choose a deployment method and bring one up. These deployments will bring up the entire backend, including api service and database
along with a V2 frontend.</li><li>Need to make changes to the backend code? Follow the below <a href="#Backend-Development">Backend Development</a> set up guide</li></ul></li><li>Install <a href="https://nodejs.org">NodeJs</a> (minimum node version 12.13.0)</li><li>Install <a href="https://cli.angular.io/" target="_blank" rel="noopener noreferrer">Angular CLI</a> - <code>npm install -g @angular/cli</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="configuration"></a>Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuration" title="Direct link to heading">#</a></h3><p>Configuration information can be found in two places</p><ul><li><code>./proxy.conf.js</code><ul><li>In new forks this is missing and needs to be created using <code>./proxy.conf.template.js</code> as a template.</li><li>Contains the address of the backend. Which will either be...<ul><li>If the backend is deployed via the instructions in the <a href="https://github.com/cloudfoundry/stratos/blob/master/deploy/README.md">deploy section</a>
the url will be the same address as the V1 console&#x27;s frontend address. For instance <code>https://localhost</code> would translate to<div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">const PROXY_CONFIG = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;/pp&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;target&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;host&quot;: &quot;localhost&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;protocol&quot;: &quot;https:&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;port&quot;: 443</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;secure&quot;: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;changeOrigin&quot;: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;ws&quot;: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div></li><li>If the backend is running locally using the instructions <a href="#Backend-Development">Backend Development</a> below the url will local host
with a port of the <code>CONSOLE_PROXY_TLS_ADDRESS</code> value from <code>src/jetstream/config.properties</code>. By default this will be 5445. For
instance<div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">const PROXY_CONFIG = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;/pp&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;target&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;host&quot;: &quot;localhost&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;protocol&quot;: &quot;https:&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;port&quot;: 5443</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;ws&quot;: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;secure&quot;: false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;changeOrigin&quot;: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div></li></ul></li></ul></li><li><code>./src/frontend/environments/environment.ts</code> for developer vs production like config<ul><li>This contains more general settings for the frontend and does not usually need to be changed</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="run-the-frontend"></a>Run the frontend<a aria-hidden="true" tabindex="-1" class="hash-link" href="#run-the-frontend" title="Direct link to heading">#</a></h2><ol><li>(First time only) Copy <code>./proxy.conf.template.js</code> to <code>./proxy.conf.js</code> and update with required Jetstream url (see above for more info)</li><li>Run <code>npm install</code></li><li>Run <code>npm start</code> for a dev server. (the app will automatically reload if you change any of the source files)<ul><li>If this times out please use <code>npm run start-high-mem</code> instead</li><li>To change the port from the default 4200, add <code>-- --port [new port number]</code></li><li>To stop the automatic reload every time a resource changes add <code>-- --live-reload false</code></li><li>To do both the above use <code>-- --live-reload false --port [new port number]</code></li></ul></li><li>Navigate to <code>https://localhost:4200/</code>. The credentials to log in will be dependent on the Jetstream the console points at. Please refer
to the guides used when setting up the backend for more information</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="build"></a>Build<a aria-hidden="true" tabindex="-1" class="hash-link" href="#build" title="Direct link to heading">#</a></h2><p>Run <code>npm run build</code> to build the project.</p><p>The build artefacts will be stored in the <code>dist/</code> directory. This will output a production build of the application.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="creating-angular-items-via-angular-cli"></a>Creating angular items via angular cli<a aria-hidden="true" tabindex="-1" class="hash-link" href="#creating-angular-items-via-angular-cli" title="Direct link to heading">#</a></h2><p>To create a new angular component run <code>ng generate component component-name</code>. You can use a similar command to create other types of angular
items <code>ng generate &lt;directive|pipe|service|class|guard|interface|enum|module&gt; &lt;name&gt;</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="theming"></a>Theming<a aria-hidden="true" tabindex="-1" class="hash-link" href="#theming" title="Direct link to heading">#</a></h2><p>We use the angular material theming mechanism. See <a href="https://material.angular.io/guide/theming-your-components" target="_blank" rel="noopener noreferrer">here</a> for more information about theming new components added to stratos.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="test"></a>Test<a aria-hidden="true" tabindex="-1" class="hash-link" href="#test" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="lint"></a>Lint<a aria-hidden="true" tabindex="-1" class="hash-link" href="#lint" title="Direct link to heading">#</a></h3><p>Run <code>npm run lint</code> to execute tslint lint checking.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="unit-tests"></a>Unit tests<a aria-hidden="true" tabindex="-1" class="hash-link" href="#unit-tests" title="Direct link to heading">#</a></h3><p>Run <code>npm test</code> to execute the unit tests via <a href="https://karma-runner.github.io">Karma</a>. Coverage information can be found in <code>./coverage</code></p><p>To execute an individual package run <code>ng test &lt;package name&gt;</code>. To execute the tests again automatically on code changes add <code>--watch=true</code></p><blockquote><p><strong>NOTE</strong> npm test will search for chrome on your path. If this is not so please set an env var CHROME_BIN pointing to your executable
(chromium is fine too).</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="end-to-end-tests"></a>End-to-end tests<a aria-hidden="true" tabindex="-1" class="hash-link" href="#end-to-end-tests" title="Direct link to heading">#</a></h3><p>Run <code>npm run e2e</code> to execute the end-to-end tests via <a href="http://www.protractortest.org/" target="_blank" rel="noopener noreferrer">Protractor</a>.</p><p>Run <code>npm run e2e-dev</code> to execute end-to-end tests against a locally running instance on <code>https://localhost:4200</code></p><p>More information on the E2E tests and pre-requisites for running them is available here - <a href="/docs/guides/developers/developers-guide-e2e-tests">E2E Tests</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="code-climate"></a>Code Climate<a aria-hidden="true" tabindex="-1" class="hash-link" href="#code-climate" title="Direct link to heading">#</a></h3><p>We use <a href="https://codeclimate.com/github/cloudfoundry-incubator/stratos" target="_blank" rel="noopener noreferrer">Code Climate</a> to check for general code quality issues. This executes against Pull
Requests on creation/push.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="running-code-climate-locally"></a>Running Code Climate locally<a aria-hidden="true" tabindex="-1" class="hash-link" href="#running-code-climate-locally" title="Direct link to heading">#</a></h4><blockquote><p>Generally we would not advise doing this and just rely on the code climate gate to run when pull requests are submitted</p></blockquote><p>To run locally see instructions <a href="https://github.com/codeclimate/codeclimate" target="_blank" rel="noopener noreferrer">here</a> to install Code Climate CLI
and engine via docker. Once set ensure you&#x27;re in the root of the project and execute the following (it may take a while)</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">codeclimate analyze</span></div></div></div></div></div><blockquote><p><strong>NOTE</strong> Unfortunately this highlights all current issues and not those that are the diff between any master and feature branch. Analyze
can be ran against a single/sub set of files, again with all current issues, but a little more digestible.</p></blockquote><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">codeclimate analyze &lt;path to file/s&gt;</span></div></div></div></div></div><p>In a feature branch to compare files that have changed to master, for instance, use the following</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">git checkout feature-branch-A</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">codeclimate analyze $(git diff --name-only master)</span></div></div></div></div></div><p>You can also run the above command via npm</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">npm run climate</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="stratos-continue-integration"></a>Stratos Continue Integration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#stratos-continue-integration" title="Direct link to heading">#</a></h3><p>For each new pull request and any subsequent pushes to it the following actions are executed</p><ul><li>Code quality analysis via Code Climate - <a href="https://codeclimate.com/" target="_blank" rel="noopener noreferrer">https://codeclimate.com/</a></li><li>Jenkins CI run, covering..<ul><li>Frontend lint check</li><li>Backend lint check</li><li>Frontend unit tests</li><li>Backend unit tests</li><li>End to end tests</li></ul></li><li>Security anaylsis via Snyk - <a href="https://snyk.io/" target="_blank" rel="noopener noreferrer">https://snyk.io/</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="backend-development"></a>Backend Development<a aria-hidden="true" tabindex="-1" class="hash-link" href="#backend-development" title="Direct link to heading">#</a></h2><p>Jetstream is the back-end for Stratos. It is written in Go.</p><p>We use Go Modules for dependency management.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="pre-requisites"></a>Pre-requisites<a aria-hidden="true" tabindex="-1" class="hash-link" href="#pre-requisites" title="Direct link to heading">#</a></h3><p>You will need the following installed/available:</p><ul><li>go 1.12 or later.</li></ul><p>*For authentication, <strong>either*</strong></p><ul><li>A UAA instance</li><li>A local user account </li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="building-the-back-end"></a>Building the back-end<a aria-hidden="true" tabindex="-1" class="hash-link" href="#building-the-back-end" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="build-1"></a>Build<a aria-hidden="true" tabindex="-1" class="hash-link" href="#build-1" title="Direct link to heading">#</a></h4><p>From the <code>src/jetstream</code> folder, build the Stratos back-end with:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">npm run build-backend</span></div></div></div></div></div><p>The back-end executable is named <code>jetstream</code> and should be created within the <code>src/jetstream</code> folder.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="configuration-1"></a>Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuration-1" title="Direct link to heading">#</a></h3><p>Configuration can either be done via</p><ul><li>Environment Variable and/or Config File</li><li>In the UI when you first use a front end with this backend</li></ul><p>In all cases the configuration is saved to the database on first run. Any subsequent changes require the db to be reset. For the default sqlite
db provider this can be done by deleting <code>src/jetstream/console-database.db</code></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="configure-by-environment-variables-andor-config-file"></a>Configure by Environment Variables and/or Config File<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configure-by-environment-variables-andor-config-file" title="Direct link to heading">#</a></h4><p>By default, the configuration in file <code>src/jetstream/default.config.properties</code> will be used. These can be changed by environment variables
or an overrides file.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="environment-variable"></a>Environment variable<a aria-hidden="true" tabindex="-1" class="hash-link" href="#environment-variable" title="Direct link to heading">#</a></h5><p>If you wish to use a local user account, ensure you have set the following environment variables:</p><ul><li><code>AUTH_ENDPOINT_TYPE=local</code></li><li><code>LOCAL_USER</code> - The username for the local user</li><li><code>LOCAL_USER_PASSWORD</code> - The password for the local user</li><li><code>LOCAL_USER_SCOPE=stratos.admin</code> - This gives the local user admin permissions. Currently other roles are not available.</li></ul><p>If you have a custom uaa, ensure you have set the following environment variables:</p><ul><li><code>UAA_ENDPOINT</code>- the URL of your UAA<ul><li>If you have an existing CF and want to use the same UAA use the <code>authorization_endpoint</code> value from <code>[cf url]/v2/info</code>
For example for PCF Dev, use: <code>UAA_ENDPOINT=https://login.local.pcfdev.io</code>.</li></ul></li><li><code>CONSOLE_CLIENT</code> - the Client ID to use when authenticating against your UAA (defaults to: &#x27;cf&#x27;)</li><li><code>CONSOLE_CLIENT_SECRET</code> - the Client ID to use when authenticating against your UAA (defaults to empty)</li><li><code>CONSOLE_ADMIN_SCOPE</code> - an existing UAA scope that will be used to identify users as <code>Stratos Admins</code></li></ul><blockquote><p>To use a pre-built Stratos UAA container execute <code>docker run --name=uaa --rm -p 8080:8080 -P splatform/stratos-uaa</code>. The UAA will be
available at <code>http://localhost:8080</code> with a <code>CONSOLE_CLIENT</code> value of <code>console</code></p></blockquote><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="config-file"></a>Config File<a aria-hidden="true" tabindex="-1" class="hash-link" href="#config-file" title="Direct link to heading">#</a></h5><p>To easily persist configuration settings copy <code>src/jetstream/default.config.properties</code> to <code>src/jetstream/config.properties</code>. The backend will load its
configuration from this file in preference to the default config file, if it exists. You can also modify individual configuration settings
by setting the corresponding environment variable.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="to-configure-a-local-user-account-via-config-file"></a>To configure a local user account via config file<a aria-hidden="true" tabindex="-1" class="hash-link" href="#to-configure-a-local-user-account-via-config-file" title="Direct link to heading">#</a></h5><p>In <code>src/jetstream/config.properties</code> uncomment the following lines:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">AUTH_ENDPOINT_TYPE=local</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LOCAL_USER=localuser</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LOCAL_USER_PASSWORD=localuserpass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LOCAL_USER_SCOPE=stratos.admin</span></div></div></div></div></div><p>Load the Stratos UI and proceed to log in using the configured credentials.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="to-configure-uaa-via-stratos"></a>To configure UAA via Stratos<a aria-hidden="true" tabindex="-1" class="hash-link" href="#to-configure-uaa-via-stratos" title="Direct link to heading">#</a></h4><ol><li>Go through the <code>Config File</code> step above and comment out the <code>UAA_ENDPOINT</code> with a <code>#</code> in the new <code>config.properties</code> file.</li><li>If any previous configuration attempt has been made reset your database as described above.</li><li>Continue these steps from <a href="#run">Run</a>.<ul><li>You should see the line <code>Will add setup route and middleware</code> in the logs</li></ul></li><li>Load the Stratos UI as usual and you should be immediately directed to the setup wizard</li></ol><p>The setup wizard that allows you to enter the values normally fetched from environment variables or files. The UI will assist you through
this process, validating that the UAA address and credentials are correct. It will also provide a list of possible scopes for the Stratos Admin</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="run"></a>Run<a aria-hidden="true" tabindex="-1" class="hash-link" href="#run" title="Direct link to heading">#</a></h4><p>Execute the following file from <code>src/jetstream</code></p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">jetstream</span></div></div></div></div></div><p>You should see the log as the backend starts up. You can press CTRL+C to stop the backend.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="automatically-register-and-connect-to-an-existing-endpoint"></a>Automatically register and connect to an existing endpoint<a aria-hidden="true" tabindex="-1" class="hash-link" href="#automatically-register-and-connect-to-an-existing-endpoint" title="Direct link to heading">#</a></h4><p>To automatically register a Cloud Foundry add the environment variable/config setting below:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">AUTO_REG_CF_URL=&lt;api url of cf&gt;</span></div></div></div></div></div><p>Jetstream will then attempt to auto-connect to it with the credentials supplied when logging into Stratos.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="running-jetstream-in-a-container"></a>Running Jetstream in a container<a aria-hidden="true" tabindex="-1" class="hash-link" href="#running-jetstream-in-a-container" title="Direct link to heading">#</a></h4><p>We recommend running Stratos using the Docker All-In-One image.</p><ul><li>Follow instructions in the deploy/all-in-one docs</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/cloudfoundry/stratos/edit/master/website/docs/guides/developers/developers-guide.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/guides/contribution/contributing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Contributing to Stratos</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/guides/developers/developers-guide-env-tech"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Stratos Tech + Developer Environment »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#frontend-development" class="table-of-contents__link">Frontend Development</a><ul><li><a href="#introduction-to-the-stack" class="table-of-contents__link">Introduction to the stack</a></li><li><a href="#set-up-dependencies" class="table-of-contents__link">Set up Dependencies</a></li><li><a href="#configuration" class="table-of-contents__link">Configuration</a></li></ul></li><li><a href="#run-the-frontend" class="table-of-contents__link">Run the frontend</a></li><li><a href="#build" class="table-of-contents__link">Build</a></li><li><a href="#creating-angular-items-via-angular-cli" class="table-of-contents__link">Creating angular items via angular cli</a></li><li><a href="#theming" class="table-of-contents__link">Theming</a></li><li><a href="#test" class="table-of-contents__link">Test</a><ul><li><a href="#lint" class="table-of-contents__link">Lint</a></li><li><a href="#unit-tests" class="table-of-contents__link">Unit tests</a></li><li><a href="#end-to-end-tests" class="table-of-contents__link">End-to-end tests</a></li><li><a href="#code-climate" class="table-of-contents__link">Code Climate</a></li><li><a href="#stratos-continue-integration" class="table-of-contents__link">Stratos Continue Integration</a></li></ul></li><li><a href="#backend-development" class="table-of-contents__link">Backend Development</a><ul><li><a href="#pre-requisites" class="table-of-contents__link">Pre-requisites</a></li><li><a href="#building-the-back-end" class="table-of-contents__link">Building the back-end</a></li><li><a href="#configuration-1" class="table-of-contents__link">Configuration</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/doc2/">Deploying Stratos</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://cloudfoundry.slack.com/?redir=%2Fmessages%2Fstratos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://github.com/cloudfoundry/stratos" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/talks">Presentations and Talks</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 Cloud Foundry Foundation</div></div></div></footer></div>
<script src="/styles.d3be2d04.js"></script>
<script src="/runtime~main.de635b0d.js"></script>
<script src="/main.777ea05f.js"></script>
<script src="/1.222372fe.js"></script>
<script src="/2.34eb096d.js"></script>
<script src="/44.c6ce18b1.js"></script>
<script src="/45.0e0f5b82.js"></script>
<script src="/20ac7829.07547941.js"></script>
<script src="/17896441.836a2f96.js"></script>
<script src="/1ca4dc62.61ebe050.js"></script>
</body>
</html>